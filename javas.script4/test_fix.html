<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .test-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
        }
        .success { border-color: #28a745; background-color: #d4edda; }
        .error { border-color: #dc3545; background-color: #f8d7da; }
        .info { border-color: #17a2b8; background-color: #d1ecf1; }
        
        button {
            padding: 12px 20px;
            margin: 8px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .btn-primary { background-color: #667eea; color: white; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-danger { background-color: #dc3545; color: white; }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .emoji-test {
            font-size: 2rem;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîß –¢–µ—Å—Ç –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó</h1>
        
        <div class="test-section info">
            <h3>‚úÖ –©–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ:</h3>
            <ul>
                <li>–ü–æ–º–∏–ª–∫–∞ –≤ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –≤–∏—Ä–∞–∑—ñ –¥–ª—è emoji</li>
                <li>–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ —É –≤—Å—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ—è—Ö</li>
                <li>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è DOM –µ–ª–µ–º–µ–Ω—Ç—ñ–≤</li>
                <li>–î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>1. –¢–µ—Å—Ç emoji –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó</h3>
            <button class="btn-primary" onclick="testEmojiConversion()">–¢–µ—Å—Ç emoji</button>
            <div id="emojiStatus" class="status"></div>
            <div id="emojiTest" class="emoji-test"></div>
        </div>

        <div class="test-section">
            <h3>2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</h3>
            <button class="btn-primary" onclick="createTestUser()">–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</button>
            <button class="btn-success" onclick="checkUser()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</button>
            <div id="userStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h3>3. –¢–µ—Å—Ç —á–∞—Ç—É</h3>
            <button class="btn-primary" onclick="openChat()">–í—ñ–¥–∫—Ä–∏—Ç–∏ —á–∞—Ç</button>
            <button class="btn-success" onclick="openTestPage()">–í—ñ–¥–∫—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª</button>
            <div id="chatStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h3>4. –û—á–∏—â–µ–Ω–Ω—è</h3>
            <button class="btn-danger" onclick="clearData()">–û—á–∏—Å—Ç–∏—Ç–∏ –¥–∞–Ω—ñ</button>
            <div id="clearStatus" class="status"></div>
        </div>
    </div>

    <script>
        function testEmojiConversion() {
            try {
                // Test the emoji conversion function
                const testTexts = [
                    '–ü—Ä–∏–≤—ñ—Ç :) —è–∫ —Å–ø—Ä–∞–≤–∏?',
                    '–Ø —Å—É–º—É—é :(',
                    '–¶–µ –∫—Ä—É—Ç–æ :D',
                    '–ü—ñ–¥–º–æ—Ä–≥–Ω—É–≤ ;)',
                    '–õ—é–±–ª—é —Ç–µ–±–µ <3',
                    '–°–º–∞–π–ª–∏–∫ :P',
                    '–ó–¥–∏–≤–æ–≤–∞–Ω–∏–π :O',
                    '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–∏–π :|'
                ];
                
                let result = '<div class="info"><strong>–¢–µ—Å—Ç emoji –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó:</strong><br>';
                testTexts.forEach(text => {
                    const converted = convertEmojis(text);
                    result += `"${text}" ‚Üí "${converted}"<br>`;
                });
                result += '</div>';
                
                document.getElementById('emojiStatus').innerHTML = result;
                document.getElementById('emojiTest').innerHTML = 'üòä üò¢ üòÉ üòâ ‚ù§Ô∏è üòõ üòÆ üòê';
                
            } catch (error) {
                document.getElementById('emojiStatus').innerHTML = 
                    '<div class="error">‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message + '</div>';
            }
        }
        
        function convertEmojis(text) {
            // Same logic as in chat.js
            const emojiMap = {
                ':\\)': 'üòä', ':\\(': 'üò¢', ':D': 'üòÉ', ';\\)': 'üòâ',
                '<3': '‚ù§Ô∏è', ':P': 'üòõ', ':O': 'üòÆ', ':\\|': 'üòê'
            };
            
            Object.keys(emojiMap).forEach(shortcut => {
                text = text.replace(new RegExp(shortcut, 'g'), emojiMap[shortcut]);
            });
            
            return text;
        }
        
        function createTestUser() {
            try {
                const testUser = {
                    id: 'test-user-' + Date.now(),
                    username: '–¢–µ—Å—Ç–æ–≤–∏–π–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á',
                    isOnline: true,
                    lastSeen: new Date().toISOString(),
                    createdAt: new Date().toISOString()
                };

                // Save user
                localStorage.setItem('currentUser', JSON.stringify(testUser));
                
                // Add to users list
                const users = JSON.parse(localStorage.getItem('chatUsers')) || [];
                users.push(testUser);
                localStorage.setItem('chatUsers', JSON.stringify(users));

                document.getElementById('userStatus').innerHTML = 
                    '<div class="success">‚úÖ –¢–µ—Å—Ç–æ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å—Ç–≤–æ—Ä–µ–Ω–æ: ' + testUser.username + '</div>';
                    
            } catch (error) {
                document.getElementById('userStatus').innerHTML = 
                    '<div class="error">‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message + '</div>';
            }
        }
        
        function checkUser() {
            try {
                const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                const users = JSON.parse(localStorage.getItem('chatUsers')) || [];
                
                let status = '<div class="info">';
                status += '<strong>–ü–æ—Ç–æ—á–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á:</strong> ' + (currentUser ? currentUser.username : '–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ') + '<br>';
                status += '<strong>–í—Å—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:</strong> ' + users.length + '<br>';
                status += '</div>';
                
                document.getElementById('userStatus').innerHTML = status;
                
            } catch (error) {
                document.getElementById('userStatus').innerHTML = 
                    '<div class="error">‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message + '</div>';
            }
        }
        
        function openChat() {
            try {
                window.open('chat.html', '_blank');
                document.getElementById('chatStatus').innerHTML = 
                    '<div class="success">‚úÖ –ß–∞—Ç –≤—ñ–¥–∫—Ä–∏—Ç–æ –≤ –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ</div>';
            } catch (error) {
                document.getElementById('chatStatus').innerHTML = 
                    '<div class="error">‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message + '</div>';
            }
        }
        
        function openTestPage() {
            try {
                window.open('test_instagram_style.html', '_blank');
                document.getElementById('chatStatus').innerHTML = 
                    '<div class="success">‚úÖ –¢–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –≤—ñ–¥–∫—Ä–∏—Ç–æ</div>';
            } catch (error) {
                document.getElementById('chatStatus').innerHTML = 
                    '<div class="error">‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message + '</div>';
            }
        }
        
        function clearData() {
            try {
                localStorage.clear();
                document.getElementById('clearStatus').innerHTML = 
                    '<div class="success">‚úÖ –í—Å—ñ –¥–∞–Ω—ñ –æ—á–∏—â–µ–Ω–æ</div>';
            } catch (error) {
                document.getElementById('clearStatus').innerHTML = 
                    '<div class="error">‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message + '</div>';
            }
        }
        
        // Auto-test on load
        window.onload = function() {
            testEmojiConversion();
            checkUser();
        };
    </script>
</body>
</html> 